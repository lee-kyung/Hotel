<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybats-3-mapper.dtd">
 
<mapper namespace="kr.co.hotel.eshop.EshopMapper">
	
	<select id="pro_write" resultType="kr.co.hotel.eshop.PdaeVO">
		select * from pdae order by code asc
	</select>
	
	<select id="getso" resultType="kr.co.hotel.eshop.PsoVO">
		select * from pso where daecode=#{param1}
	</select>
	
	<select id="getpcode" resultType="Integer">
		<![CDATA[ select ifnull(substring(max(pcode), 6, 4), 0)+1 from product where pcode like concat(#{param1}, '%') ]]>
	</select>
	
	<insert id="pro_write_ok" parameterType="kr.co.hotel.eshop.ProductVO">
		insert into product(pcode, title, fimg, simg, price, halin, juk, su, baefee, buyday)
		values(#{pcode}, #{title}, #{fimg}, #{simg}, #{price}, #{halin}, #{juk}, #{su}, #{baefee}, now())
	</insert>
	
	<select id="pro_list" resultType="kr.co.hotel.eshop.ProductVO">
		select *, substr(fimg, 1, instr(fimg, ",")-1) as img
		from product where pcode like concat(#{param1}, '%')
		order by ${param2} limit ${param3}, ${param4}
	</select>
	
	<select id="total" resultType="Integer">
		select ceil(count(*)/${value}) from product
	</select>
	
</mapper>